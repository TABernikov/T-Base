<!doctype html>
<html lang="en">
<head>
  <title>Bootstrap Test Table</title>
  <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="icon" href="Face\img\t-kom-ico 144.png">

    
    <link href="Face/html/css/bootstrap.min.css" rel="stylesheet">
    <link href="Face/html/css/style.css" rel="stylesheet">
    <link href="Face/html/css/bootstrap-icons.css" rel="stylesheet">

    

    <link href="Face/node_modules/handsontable/dist/handsontable.full.min.css" rel="stylesheet">
    

    <style>
      .red{
        background-color: #f50000;
      }
      .tui-grid-row-even{
        > .red.tui-grid-cell {
          background-color: #f8e0e0;
        }
        > .gray.tui-grid-cell {
          background-color: #E2E3E5; 
        }
        > .green.tui-grid-cell {
          background-color: #D1E7DD;
        }
        > .blue.tui-grid-cell {
          background-color: #e0e0f8;
        }
        > .yelow.tui-grid-cell {
          background-color: #FFF3CD;
        }
      }
      .tui-grid-row-odd{
        > .red.tui-grid-cell {
          background-color: #f8e0e0;
        }
        > .gray.tui-grid-cell {
          background-color: #D7D8DA; 
        }
        > .green.tui-grid-cell {
          background-color: #C7DBD2;
        }
        > .blue.tui-grid-cell {
          background-color: #e0e0f8;
        }
        > .yelow.tui-grid-cell {
          background-color: #F2E7C3;
        }
      }

      
    </style>

    
</head>
<body>
  

  <div class="container-fuild" style="height: 45vh; width: 95%;">

    <div id="grid2"></div>
    
  </div>


  
  

  <!--



  

  -->


  <script>


    function compareDates(date1, date2) {
      const [day1, month1, year1] = date1.split('.');
      const [day2, month2, year2] = date2.split('.');
      const formattedDate1 = new Date(`${year1}-${month1}-${day1}`).getTime();
      const formattedDate2 = new Date(`${year2}-${month2}-${day2}`).getTime();

      return formattedDate1 - formattedDate2;

    }

   





    


  </script>

<script type="text/javascript" src="Face/node_modules/handsontable/dist/handsontable.full.min.js"></script>
<script type="text/javascript" src="Face/node_modules/handsontable/dist/languages/ru-RU.min.js"></script>

<script>
  document.addEventListener("DOMContentLoaded", function() {
const container = document.getElementById('grid2');
var hot = new Handsontable(container, {
  language: 'ru-RU',

  columns: [
    {title: 'id', type: 'text', data: 'id', renderer: safeHtmlRenderer},
    {title: 'sn', type: 'text', data: 'sn', renderer: safeHtmlRenderer},
    {title: 'mac', type: 'text', data: 'mac', renderer: safeHtmlRenderer},
    {title: 'dmodel', type: 'text', data: 'dmodel', renderer: safeHtmlRenderer},
    {title: 'rev', type: 'text', data: 'rev', renderer: safeHtmlRenderer},
    {title: 'tmodel', type: 'text', data: 'tmodel', renderer: safeHtmlRenderer},
    {title: 'name', type: 'text', data: 'name', renderer: safeHtmlRenderer},
    {title: 'condition', type: 'text', data: 'condition', renderer: safeHtmlRenderer},
    {title: 'condDate', type: 'date', data: 'condDate', renderer: safeHtmlRenderer},
    {title: 'order', type: 'text', data: 'order', renderer: safeHtmlRenderer},
    {title: 'place', type: 'text', data: 'place', renderer: safeHtmlRenderer},
    {title: 'shipped', type: 'text', data: 'shipped', renderer: safeHtmlRenderer},
    {title: 'shippedDate', type: 'date', data: 'shippedDate', renderer: safeHtmlRenderer},
    {title: 'shippedDest', type: 'text', data: 'shippedDest', renderer: safeHtmlRenderer},
    {title: 'takenDate', type: 'date', data: 'takenDate', renderer: safeHtmlRenderer},
    {title: 'takenDoc', type: 'text', data: 'takenDoc', renderer: safeHtmlRenderer},
    {title: 'takenOrder', type: 'text', data: 'takenOrder', renderer: safeHtmlRenderer},
    {title: 'comment', type: 'text', data: 'comment', renderer: safeHtmlRenderer},
    {title: 'assembler', type: 'text', data: 'assembler', renderer: safeHtmlRenderer},
  ],
 
  hiddenColumns: {indicators: true,},
  hiddenRows: true,

  manualColumnMove: true,
  manualColumnFreeze: true,
  manualColumnResize: true,

  
  data: [
  {{range .}}
      {
        id: {{.Id}},
        sn: {{.Sn}},
        mac: {{.Mac}},
        dmodel: {{.DModel}},
        rev: {{.Rev}},
        tmodel: {{.TModel}},
        name: {{.Name}},
        condition: {{.Condition}},
        condDate: {{.CondDate}},
        order: {{.Order}},
        place: {{.Place}},
        shipped: {{.Shiped}},
        shippedDate: {{.ShipedDate}},
        shippedDest: {{.ShippedDest}},
        takenDate: {{.TakenDate}},
        takenDoc: {{.TakenDoc}},
        takenOrder: {{.TakenOrder}},
        comment: {{.Comment}},
        assembler: {{.Assembler}},
      
      },
      {{end}}
     
  ],

  
  filters: true,
  dropdownMenu: ['filter_by_condition', 'filter_by_value', 'filter_action_bar'],
  columnSorting: true,
  dateFormat: 'DD.MM.YYYY',
  readOnly: true,
  rowHeaders: true,
  height: '100%',
  autoWrapRow: true,
  autoWrapCol: true,
  contextMenu: {
    callback(key, selection, clickEvent) {
      // Common callback for all options
      console.log(key, selection, clickEvent);
    },
    items: {
      copy: 'copy',hidecol: 'hidden_columns_hide', showcol: 'hidden_columns_show', hiderow :'hidden_rows_hide', showrow: 'hidden_rows_show', freezcol: 'freeze_column', unfreezcol: 'unfreeze_column',
      scv: {
        name: 'Экспорт в CSV',
        callback(key, selection, clickEvent) { // Callback for specific option
          const exportPlugin = hot.getPlugin('exportFile');

          exportPlugin.downloadFile('csv', {
          bom: true,
          columnDelimiter: ';',
          columnHeaders: true,
          exportHiddenColumns: false,
          exportHiddenRows: false,
          fileExtension: 'csv',
          filename: 'Экспорт [DD].[MM].[YYYY]',
          mimeType: 'text/csv',
          rowDelimiter: '\r\n',
          rowHeaders: true
        });
        }
      },
    }
  },
  licenseKey: 'non-commercial-and-evaluation' // for non-commercial use only
  
});

hot.updateSettings({
    cells: function(row, col) {
      var cellProperties = {};

      if (hot.getDataAtCell(hot.toVisualRow(row), 7) == 'Собрано') {
        cellProperties.className = 'red';
      } 

      return cellProperties;
    },
  });
});

function safeHtmlRenderer(instance, td, row, col, prop, value, cellProperties) {
  td.innerHTML = value;
}



</script>

  <script src="Face/html/js/bootstrap.bundle.js"></script>
  <script src="Face/html/js/keys.js"></script>

  
</body>
</html>



